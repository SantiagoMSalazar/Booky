Después de instalar oracle Se crean los usuarios pertinentes con los permisos necesarios:
### Máquina virtual - ServidorN1
```sql
usuario: sys /sa sysdba
password: 12345678
SQL> ALTER SESSION SET "_Ooracle_script"=TRUE;
SQL> CREATE USER GR5 IDENTIFIED BY g1234;
SQL> GRANT DBA TO GR5;
``` 
### Máquina local - Santiago
```sql
usuario: sys /sa sysdba
password: 12345678
SQL> ALTER SESSION SET "_Ooracle_script"=TRUE;
SQL> CREATE USER gru5 IDENTIFIED BY grupo5;
SQL> GRANT DBA TO gru5;
``` 

# Validar la conexión entre servidores
### Conexión desde Santiago a ServidorN1
```bash
C:\Users\santi>ping ServidorN1

Haciendo ping a ServidorN1.local [fe80::a275:fd68:2153:a2b%17] con 32 bytes de datos:
Respuesta desde fe80::a275:fd68:2153:a2b%17: tiempo=2ms
Respuesta desde fe80::a275:fd68:2153:a2b%17: tiempo<1m
Respuesta desde fe80::a275:fd68:2153:a2b%17: tiempo<1m
Respuesta desde fe80::a275:fd68:2153:a2b%17: tiempo<1m

Estadísticas de ping para fe80::a275:fd68:2153:a2b%17:
    Paquetes: enviados = 4, recibidos = 4, perdidos = 0
    (0% perdidos),
Tiempos aproximados de ida y vuelta en milisegundos:
    Mínimo = 0ms, Máximo = 2ms, Media = 0ms

C:\Users\santi>
```
### Conexión desde ServidorN1 a Santiago
```bash
C:\Users\server1>ping Santiago

Haciendo ping a Santiago.local [fe80::1bb0:e175:910a:60f9%3] con 32 bytes de datos:
Respuesta desde fe80::1bb0:e175:910a:60f9%3: tiempo=3ms
Respuesta desde fe80::1bb0:e175:910a:60f9%3: tiempo=1ms
Respuesta desde fe80::1bb0:e175:910a:60f9%3: tiempo<1m
Respuesta desde fe80::1bb0:e175:910a:60f9%3: tiempo=1ms

Estadísticas de ping para fe80::1bb0:e175:910a:60f9%3:
    Paquetes: enviados = 4, recibidos = 4, perdidos = 0
    (0% perdidos),
Tiempos aproximados de ida y vuelta en milisegundos:
    Mínimo = 0ms, Máximo = 3ms, Media = 1ms
```
# Configuración de Net Manager para establecer esclavo

* Se realiza en el servidor esclavo (ServidorN1)
### Configuración de red
![[Pasted image 20230314162919.png]]
![[Pasted image 20230314162953.png]]
### Configuración de NetManager
![[Pasted image 20230314163114.png]]
En la configuración de los archivos
`C:\BDD\Oracle\WINDOWS.X64_193000_db_home\network\admin\tnsnames.ora`
```text
# tnsnames.ora Network Configuration File: C:\BDD\Oracle\WINDOWS.X64_193000_db_home\NETWORK\ADMIN\tnsnames.ora
# Generated by Oracle configuration tools.

DBMASTER =
  (DESCRIPTION =
    (ADDRESS_LIST =
      (ADDRESS = (PROTOCOL = TCP)(HOST = Santiago)(PORT = 1521))
    )
    (CONNECT_DATA =
      (SERVICE_NAME = orcl)
    )
  )

ORCLPDB =
  (DESCRIPTION =
    (ADDRESS_LIST =
      (ADDRESS = (PROTOCOL = TCP)(HOST = ServidorN1)(PORT = 1521))
    )
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = orclpdb)
    )
  )

LISTENER_ORCL =
  (ADDRESS = (PROTOCOL = TCP)(HOST = ServidorN1)(PORT = 1521))


ORACLR_CONNECTION_DATA =
  (DESCRIPTION =
    (ADDRESS_LIST =
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1521))
    )
    (CONNECT_DATA =
      (SID = CLRExtProc)
      (PRESENTATION = RO)
    )
  )

ORCL =
  (DESCRIPTION =
    (ADDRESS_LIST =
      (ADDRESS = (PROTOCOL = TCP)(HOST = ServidorN1)(PORT = 1521))
    )
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = orcl)
    )
  )

```
`C:\BDD\Oracle\WINDOWS.X64_193000_db_home\network\admin\listener.ora`
```text
# listener.ora Network Configuration File: C:\BDD\Oracle\WINDOWS.X64_193000_db_home\NETWORK\ADMIN\listener.ora
# Generated by Oracle configuration tools.

SID_LIST_LISTENER =
  (SID_LIST =
    (SID_DESC =
      (SID_NAME = CLRExtProc)
      (ORACLE_HOME = C:\BDD\Oracle\WINDOWS.X64_193000_db_home)
      (PROGRAM = extproc)
      (ENVS = "EXTPROC_DLLS=ONLY:C:\BDD\Oracle\WINDOWS.X64_193000_db_home\bin\oraclr19.dll")
    )
  )

LISTENER =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = TCP)(HOST = ServidorN1)(PORT = 1521))
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1521))
    )
  )


```
### Validación de la nomenclatura de servicios
```bash
C:\Users\server1>TNSPING DBMaster

TNS Ping Utility for 64-bit Windows: Version 19.0.0.0.0 - Production on 14-MAR-2023 16:36:57

Copyright (c) 1997, 2019, Oracle.  All rights reserved.

Archivos de parßmetros utilizados:
C:\BDD\Oracle\WINDOWS.X64_193000_db_home\network\admin\sqlnet.ora


Adaptador TNSNAMES utilizado para resolver el alias
Intentando contactar con (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP)(HOST = Santiago)(PORT = 1521))) (CONNECT_DATA = (SERVICE_NAME = orcl)))
Realizado correctamente (60 mseg)
```

# Scripts de configuración en Oracle Developer
Conexión con Servidor Master
![[Imagen de WhatsApp 2023-03-14 a las 16.45.00.jpg]]
## Script del servidor Master
1. Crear database link
```sql
create database link DBMegatel connect to gr5
identified by g1234
using 'DBMaster';
```
2. Crear tabla a replicar
```sql
create table Plan_M(
    idPlan      integer primary key not null,
    nombrePlan  varchar(30)
);
```
3. Crear log de vista materializada
```sql
create materialized view log on Plan_M
with primary key including new values;
```
## Script del Servidor Slave 
1. Crear database link
```sql
create database link DBMegatel
connect to gru5 identified by grupo5
using 'DBMASTER';
```
2. Crear vista materializada replicada
```sql
create materialized view Plan_M_Repl
refresh fast on demand
start with to_date('14-03-2023 00:00:01','dd-mm-yy hh24:mi:ss') next sysdate + (1/86400)
as select * from Plan_M@DBMegatel;
```
3. Crear log de vista materializada
```sql
create materialized view log on Plan_M
with primary key including new values;
```
